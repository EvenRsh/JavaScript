<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style media="screen">
        table{
            border-collapse: collapse;
            border: 1px solid #ccc;
        }
        thead{
            background-color: #ddd;
        }
        td,th{
            border: 1px solid #ccc;
            width: 100px;
            text-align: center;
        }
        tbody tr.checked{
            background-color: rgb(222, 203, 33);
        }
    </style>
    <script type="text/javascript">
        //不小心做复杂了
        window.onload = function() {
            var checkQuit = document.getElementById('checkQuit');
            var checkAll = document.getElementById('checkAll');
            var tbody = document.getElementsByTagName('tbody')[0];
            var tr = tbody.children;
            console.log(tr);
            // 当前行高亮
            tbody.onclick = function (e) {

                if(e.target.tagName.toLowerCase()==='td'){
                    var currentTr = e.target.parentElement;
                    var currentcheckbox = currentTr.children[0].children[0];
                    console.log(currentcheckbox);
                    if(currentcheckbox.checked){
                        currentcheckbox.checked = false;
                        currentTr.className = '';
                    }else{
                        currentcheckbox.checked = true;
                        currentTr.className = 'checked';
                    }
                    // 自动全选
                    var flag = true;
                    for(var i = 0;i<tr.length;i++){
                        if(!tr[i].children[0].children[0].checked){
                            checkAll.checked = false;
                            flag = false;
                            break;
                        }
                        if(flag){
                            checkAll.checked = true;
                        }
                    }
                }else{
                    console.log(e.target);
                    var currentTr = e.target.parentElement.parentElement;
                    console.log(currentTr);
                    if(e.target.checked){
                        currentTr.className = 'checked';
                    }else{
                        currentTr.className = '';
                    }
                    // 自动全选
                    var flag = true;
                    for(var i = 0;i<tr.length;i++){
                        if(!tr[i].children[0].children[0].checked){
                            checkAll.checked = false;
                            flag = false;
                            break;
                        }
                        if(flag){
                            checkAll.checked = true;
                        }
                    }
                }
            }

            // 全选
            checkAll.onclick = function (e) {
                e.stopPropagation();
                if(checkAll.checked){
                    for(var i = 0;i<tr.length;i++){
                        tr[i].children[0].children[0].checked = true;
                        tr[i].className = 'checked'
                    }
                }else{
                    for(var i = 0;i<tr.length;i++){
                        tr[i].children[0].children[0].checked = false;
                        tr[i].className = ''
                    }
                }
            }

            // 反选
            checkQuit.onclick = function () {
                for(var i = 0;i<tr.length;i++){
                    tr[i].children[0].children[0].checked = !tr[i].children[0].children[0].checked;
                    if(tr[i].className){
                        tr[i].className = ''
                    }else{
                        tr[i].className ='checked'
                    }
                }
                // 自动全选
                var flag = true;
                for(var i = 0;i<tr.length;i++){
                    if(!tr[i].children[0].children[0].checked){
                        checkAll.checked = false;
                        flag = false;
                        break;
                    }
                    if(flag){
                        checkAll.checked = true;
                    }
                }
            }
        }
    </script>
</head>
<body>
    <button type="button" name="button" id="checkQuit">反选</button>
    <table>
        <thead>
            <tr>
                <th><input type="checkbox" id="checkAll"></th>
                <th>姓名</th>
                <th>昵称</th>
                <th>性别</th>
                <th>爱好</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="checkbox" name="" value=""></td>
                <td>刘备</td>
                <td>小刘</td>
                <td>男</td>
                <td>撩妹</td>
            </tr>
            <tr>
                <td><input type="checkbox" name="" value=""></td>
                <td>刘备</td>
                <td>小刘</td>
                <td>男</td>
                <td>撩妹</td>
            </tr>
            <tr>
                <td><input type="checkbox" name="" value=""></td>
                <td>刘备</td>
                <td>小刘</td>
                <td>男</td>
                <td>撩妹</td>
            </tr>
            <tr>
                <td><input type="checkbox" name="" value=""></td>
                <td>刘备</td>
                <td>小刘</td>
                <td>男</td>
                <td>撩妹</td>
            </tr>
            <tr>
                <td><input type="checkbox" name="" value=""></td>
                <td>刘备</td>
                <td>小刘</td>
                <td>男</td>
                <td>撩妹</td>
            </tr>
        </tbody>
    </table>
</body>
</html>
